{"library_version": "8.6.1", "change_type": "Bug Fixes", "change_id": "LUCENE-9443", "change_description": ": The UnifiedHighlighter was closing the underlying reader when there were multiple term-vector fields.\nThis was a regression in 8.6.0.", "change_title": "\"IndexReader is closed\" regression in highlighter", "detail_type": "Bug", "detail_affect_versions": "8.6", "detail_fix_versions": "8.6.1", "detail_description": "I'm seeing a regression the UnifiedHighlighter (observed in Solr 8.6, leading to a crashed core), likely caused by LUCENE-9376 (https://github.com/apache/lucene-solr/commit/8e578b4e51cbab206c31653077ce4a3e3a6879b8#diff-f545e503a21f7331f0706fb89f7c663eR648?) dsmiley  adds: [the] call to close indexReaderWithTermVecCache but this is a wrapper IndexReader that is not supposed to be closed. It'll close the underlying real reader if you do which is nasty as that's the live one, which thus brings down the core. This is reproducible with Solr 8.6, a trivial configuration  (https://gist.github.com/cbeer/6d3191918b39e3e83e80ac48c00de925),  and an empty index with a request like: http://127.0.0.1:8983/solr/blacklight-core/select?q=id:[*+TO+*]&hl=true&hl.fl=full_text_search_en+full_text_search_pt&hl.offsetSource=postings_with_term_vectors&hl.method=unified ", "patch_link": "none", "patch_content": "none"}
