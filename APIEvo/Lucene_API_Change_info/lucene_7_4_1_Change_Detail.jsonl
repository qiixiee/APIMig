{"library_version": "7.4.1", "change_type": "Bug Fixes", "change_id": "LUCENE-8365", "change_description": ": Fix ArrayIndexOutOfBoundsException in UnifiedHighlighter. This fixes a off by one error in the UnifiedHighlighter's code that is only triggered when two nested SpanNearQueries contain the same term.(Marc-Andre Morissette via Simon Willnauer)", "change_title": "ArrayIndexOutOfBoundsException in UnifiedHighlighter", "detail_type": "Bug", "detail_affect_versions": "7.3.1", "detail_fix_versions": "7.4.1,7,5,8.0", "detail_description": "We see ArrayIndexOutOfBoundsExceptions coming out of the UnifiedHighlighter in our production logs from time to time:It turns out that there is an off by one error in the UnifiedHighlighter's code that, as far as I can tell, is only triggered when two nested SpanNearQueries contain the same term.The resulting behaviour depends on the content of the highlighted document. Either, some highlighted terms go missing or an ArrayIndexOutOfBoundsException is thrown.", "patch_link": "none", "patch_content": "none"}
{"library_version": "7.4.1", "change_type": "Bug Fixes", "change_id": "LUCENE-8381", "change_description": "Fix IndexWriter incorrectly interprets hard-deletes as soft-deletes while wrapping reader for merges.", "change_title": "IW counts hard-deletes as soft-deletes in merges","detail_type": "Bug", "detail_affect_versions": "7.4.1", "detail_fix_versions": "7.4.1,7,5,8.0", "detail_description": "If a document is soft-deleted, then hard-deleted, IW, however, accounts that document as soft-deleted when wrapping readers for merges.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12930281/LUCENE-8381.patch", "patch_content": "none"}
{"library_version": "7.4.1", "change_type": "Bug Fixes", "change_id": "LUCENE-8384", "change_description": "Fix missing advance docValues generation while handling docValues update in PendingSoftDeletes.", "change_title": "SoftDeleteCount assertion in SoftPendingDeletes violated", "detail_type": "Bug", "detail_affect_versions": "7.4", "detail_fix_versions": "7.4.1,7,5,8.0", "detail_description": "A spinoff from LUCENE-8381. If a soft-deletes docvalues was applied to PendingSoftDeletes already, newDelCount should be less than the softDelCount recorded in SegmentInfo. The attached test trips an assertion in PendingSoftDeletes. I think we need to relax that assertion.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12930300/LUCENE-8384.patch", "patch_content": "none"}
{"library_version": "7.4.1", "change_type": "Bug Fixes", "change_id": "LUCENE-8472", "change_description": "Always rewrite the soft-deletes merge retention query.", "change_title": "Soft-deletes merge retention query should be rewritten", "detail_type": "Bug", "detail_affect_versions": "7.4.1,7,5,8.0", "detail_fix_versions": "7.4.1,7,5,8.0", "detail_description": "We should rewrite the retention query before passing it into createWeight in SoftDeletesRetentionMergePolicy#getScorer method.", "patch_link":"https://issues.apache.org/jira/secure/attachment/12937846/LUCENE-8472.patch","patch_content": "none"}
