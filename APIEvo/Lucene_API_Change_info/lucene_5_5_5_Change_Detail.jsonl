{"library_version": "5.5.5", "change_type": "Changes in Runtime Behavior", "change_id": "SOLR-11477", "change_description": "Resolving of external entities in queryparser/xml/CoreParser is disallowed\nby default. See", "change_title": "CVE-2017-12629: Disable external entities in XML query parser", "detail_type": "Task", "detail_affect_versions": "None", "detail_fix_versions": "5.5.5,6.6.2,7.1,7.2,8.0", "detail_description": "Lucene includes a query parser that is able to create the full-spectrum of Lucene queries, using an XML data structure. Starting from version 5.1 Solr supports \"xml\" query parser in the search query. The problem is that lucene xml parser does not explicitly prohibit doctype declaration and expansion of external entities. It is possible to include special entities in the xml document, that point to external files (via file://) or external urls (via http://): Example usage: When Solr is parsing this request, it makes a HTTP request to http://xxx.s.artsploit.com/xxx and treats its content as DOCTYPE definition. Considering that we can define parser type in the search query, which is very often comes from untrusted user input, e.g. search fields on websites. It allows to an external attacker to make arbitrary HTTP requests to the local SOLR instance and to bypass all firewall restrictions. For example, this vulnerability could be user to send malicious data to the '/upload' handler: This vulnerability can also be exploited as Blind XXE using ftp wrapper in order to read arbitrary local files from the solrserver.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12892047/SOLR-11477.patch", "patch_content": "none"}
{"library_version": "5.5.5", "change_type": "Bug Fixes", "change_id": "LUCENE-7419", "change_description": ": Fix performance bug with TokenStream.end(), where it would lookup\nPositionIncrementAttribute every time.", "change_title": "performance bug in tokenstream.end()", "detail_type": "Bug", "detail_affect_versions": "None", "detail_fix_versions": "5.5.5,6.2,7.0", "detail_description": "TokenStream.end() calls getAttribute(), which is pretty costly to do per-stream. It does its current hack, because in the ctor of TokenStream is \"too early\". Instead, we can just add a variant of clear(), called end() to AttributeImpl. For most attributes it defers to clear, but for PosIncAtt it can handle the special case.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12824445/LUCENE-7419.patch", "patch_content": "none"}
{"library_version": "5.5.5", "change_type": "Bug Fixes", "change_id": "SOLR-11477", "change_description": ": Disallow resolving of external entities in queryparser/xml/CoreParser\nby default.", "change_title": "CVE-2017-12629: Disable external entities in XML query parser", "detail_type": "Task", "detail_affect_versions": "None", "detail_fix_versions": "5.5.5,6.6.2,7.1,7.2,8.0", "detail_description": "Lucene includes a query parser that is able to create the full-spectrum of Lucene queries, using an XML data structure. Starting from version 5.1 Solr supports \"xml\" query parser in the search query. The problem is that lucene xml parser does not explicitly prohibit doctype declaration and expansion of external entities. It is possible to include special entities in the xml document, that point to external files (via file://) or external urls (via http://): Example usage: When Solr is parsing this request, it makes a HTTP request to http://xxx.s.artsploit.com/xxx and treats its content as DOCTYPE definition. Considering that we can define parser type in the search query, which is very often comes from untrusted user input, e.g. search fields on websites. It allows to an external attacker to make arbitrary HTTP requests to the local SOLR instance and to bypass all firewall restrictions. For example, this vulnerability could be user to send malicious data to the '/upload' handler: This vulnerability can also be exploited as Blind XXE using ftp wrapper in order to read arbitrary local files from the solrserver.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12892047/SOLR-11477.patch", "patch_content": "none"}
