{"library_version": "6.4.2", "change_type": "Bug Fixes", "change_id": "LUCENE-7698", "change_description": ": CommonGramsQueryFilter was producing a disconnected\ntoken graph, messing up phrase queries when it was used during query\nparsing", "change_title": "CommonGramsQueryFilter in the query analyzer chain breaks phrase queries", "detail_type": "Bug", "detail_affect_versions": "6.4,6.4.1", "detail_fix_versions": "6.4.2,7.0", "detail_description": "(Please pardon me if the project or component are wrong!) CommonGramsQueryFilter breaks phrase queries. The behavior also seems to change with addition or removal of adjacent terms. Steps to reproduce: 1.) Download and extract Solr (in my test case version 6.4.1) somewhere. 2.) Modify server/solr/configsets/sample_techproducts_configs/conf/managed-schema and modify text_general fieldType by adding CommonGrams(Query)Filter before stopWordFilter: <fieldType name=\"text_general\" class=\"solr.TextField\" positionIncrementGap=\"100\">       <analyzer type=\"index\">         <tokenizer class=\"solr.StandardTokenizerFactory\"/>         <filter class=\"solr.CommonGramsFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\" />         <filter class=\"solr.StopFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\" />         <!-- in this example, we will only use synonyms at query time         <filter class=\"solr.SynonymFilterFactory\" synonyms=\"index_synonyms.txt\" ignoreCase=\"true\" expand=\"false\"/>         -->         <filter class=\"solr.LowerCaseFilterFactory\"/>       </analyzer>       <analyzer type=\"query\">         <tokenizer class=\"solr.StandardTokenizerFactory\"/>         <filter class=\"solr.CommonGramsQueryFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\"/>         <filter class=\"solr.StopFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\" />         <filter class=\"solr.SynonymFilterFactory\" synonyms=\"synonyms.txt\" ignoreCase=\"true\" expand=\"true\"/>         <filter class=\"solr.LowerCaseFilterFactory\"/>       </analyzer>     </fieldType> 3.) Add \"with\" to server/solr/configsets/sample_techproducts_configs/conf/stopwords.txt and make sure the file has correct line endings (extracted from Solr zip it seems to contain DOS/Windows lien endings which may break things). 4.) Run the techproducts example with \"bin/solr -e techproducts\" 5.) Browse to <http://localhost:8983/solr/techproducts/select?q=%22iPod%20with%20Video%22&debugQuery=true> 6.) Observe that parsedquery in the debug output is empty 7.) Browse to <http://localhost:8983/solr/techproducts/select?q=%22Apple%2060%20GB%20iPod%20with%20Video%20Playback%20Black%22&debugQuery=true> 8.) Observe that parsedquery contains ipod_with as expected but not with_video.", "patch_link": "https://issues.apache.org/jira/secure/attachment/12853280/LUCENE-7698.patch", "patch_content": "none"}
{"library_version": "6.4.2", "change_type": "Bug Fixes", "change_id": "LUCENE-7676", "change_description": ": Fixed FilterCodecReader to override more super-class methods.\nAlso added TestFilterCodecReader class.", "change_title": "FilterCodecReader to override more super-class methods", "detail_type": "Bug", "detail_affect_versions": "None", "detail_fix_versions": "6.4.2,6.5,7.0", "detail_description": "none", "patch_link": "https://issues.apache.org/jira/secure/attachment/12851177/LUCENE-7676.patch", "patch_content": "none"}
{"library_version": "6.4.2", "change_type": "Bug Fixes", "change_id": "LUCENE-7717", "change_description": ": The UnifiedHighlighter and PostingsHighlighter were not highlighting\nprefix queries with multi-byte characters. TermRangeQuery is affected too.", "change_title": "UnifiedHighlighter doesn't highlight PrefixQuery with multi-byte chars", "detail_type": "Bug", "detail_affect_versions": "5.1,6.3,6.4.1", "detail_fix_versions": "6.4.2", "detail_description": "UnifiedHighlighter highlighter = new UnifiedHighlighter(null, new StandardAnalyzer()); Query query = new PrefixQuery(new Term(\"title\", \"я\")); String testData = \"я\"; Object snippet = highlighter.highlightWithoutSearcher(fieldName, query, testData, 1); System.out.printf(\"testData=[%s] Query=%s snippet=[%s]\\n\", testData, query, snippet==null?null:snippet.toString());", "patch_link": "https://issues.apache.org/jira/secure/attachment/12855211/LUCENE-7717.patch", "patch_content": "none"}
